<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" data-mode="dark">
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="Bypass the Network Authentication with DNS Tunnelling" />
<meta name="author" content="Theodore Cooper" />
<meta property="og:locale" content="en" />
<meta name="description" content="Data through port 53 is not intercepted, and the authentication system can be bypassed using the DNS channel." />
<meta property="og:description" content="Data through port 53 is not intercepted, and the authentication system can be bypassed using the DNS channel." />
<link rel="canonical" href="http://localhost:4000/posts/dns/" />
<meta property="og:url" content="http://localhost:4000/posts/dns/" />
<meta property="og:site_name" content="Blog the0cp" />
<meta property="og:image" content="http://localhost:4000/assets/img/blog/dns/dns.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-11-09T00:00:00+09:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/assets/img/blog/dns/dns.jpg" />
<meta property="twitter:title" content="Bypass the Network Authentication with DNS Tunnelling" />
<meta name="twitter:site" content="@T_Ccooper" />
<meta name="twitter:creator" content="@T_Ccooper" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Theodore Cooper","url":"https://github.com/the0cp/"},"dateModified":"2024-11-09T00:00:00+09:00","datePublished":"2024-11-09T00:00:00+09:00","description":"Data through port 53 is not intercepted, and the authentication system can be bypassed using the DNS channel.","headline":"Bypass the Network Authentication with DNS Tunnelling","image":"http://localhost:4000/assets/img/blog/dns/dns.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/dns/"},"url":"http://localhost:4000/posts/dns/"}</script>
<!-- End Jekyll SEO tag -->


  <title>Bypass the Network Authentication with DNS Tunnelling | Blog | the0cp
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Blog | the0cp">
<meta name="application-name" content="Blog | the0cp">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.6.0/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.29.0/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- JavaScript -->

  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/avatar.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">Blog | the0cp</a>
    <p class="site-subtitle fst-italic mb-0">Talk is cheap, show me the code.</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    

    
      

      
        <a
          href="https://github.com/the0cp"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/T_Ccooper"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['ccooperr2005','gmail.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>Bypass the Network Authentication with DNS Tunnelling</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  




<!-- return -->










<article class="px-1" data-toc="true">
  <header>
    <h1 data-toc-skip>Bypass the Network Authentication with DNS Tunnelling</h1>
    
      <p class="post-desc fw-light mb-4">Data through port *53* is not intercepted, and the authentication system can be bypassed using the DNS channel.
</p>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1731078000"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Nov  9, 2024
</time>

      </span>

      <!-- lastmod date -->
      

      
        
        
        

        

        <div class="mt-3 mb-3">
          <a href="/assets/img/blog/dns/dns.jpg" class="popup img-link preview-img shimmer"><img src="/assets/img/blog/dns/dns.jpg"  alt="Preview Image" width="1200" height="630"  loading="lazy"></a></div>
      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              
                <a href="https://github.com/the0cp/">Theodore Cooper</a>
                
              
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="1604 words"
>
  <em>8 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  
    <div id="toc-bar" class="d-flex align-items-center justify-content-between invisible">
      <span class="label text-truncate">Bypass the Network Authentication with DNS Tunnelling</span>
      <button type="button" class="toc-trigger btn me-1">
        <i class="fa-solid fa-list-ul fa-fw"></i>
      </button>
    </div>

    <button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm">
      <span class="label ps-2 pe-1">Contents</span>
      <i class="fa-solid fa-angle-right fa-fw"></i>
    </button>

    <dialog id="toc-popup" class="p-0">
      <div class="header d-flex flex-row align-items-center justify-content-between">
        <div class="label text-truncate py-2 ms-4">Bypass the Network Authentication with DNS Tunnelling</div>
        <button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75">
          <i class="fas fa-close"></i>
        </button>
      </div>
      <div id="toc-popup-content" class="px-4 py-3 pb-4"></div>
    </dialog>
  

  <div class="content">
    <p>After connecting to a AP, the authentication system will want you to log in to access the Internet.
However, in some authentication system, <code class="language-plaintext highlighter-rouge">nslookup</code> can still work properly even whithout logging in. Therefore, data through port <em>53</em> is not intercepted, and the authentication system can be bypassed using the DNS channel.</p>

<blockquote class="prompt-info">
  <p>Port 53 is the default port for DNS. It is the port most web applications expect to find DNS servers, which they use to translate domains into IP addresses.</p>
</blockquote>

<p><strong><em>DNS tunneling</em></strong> is a DNS attack technique that involves encoding the information of other protocols or programs in DNS queries and responses. DNS tunneling generally features data payloads which can latch onto a target DNS server, allowing the attacker to manage applications and the remote server.</p>

<p>DNS tunneling tends to rely on the external network connectivity of the compromised systemâ€”DNS tunneling needs a way into an internal DNS server that has network access. Attackers also have to control a <strong><em>server</em></strong> and a <strong><em>domain</em></strong> that may function as an <strong><em>authoritative server</em></strong> to carry out data payload executable programs and server-side tunneling.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>PS C:\Users\Admin&gt; nslookup.exe bing.com
Server: UnKnown
Address: xx.xxx.xx.xxx
Non-authoritative answer:
Name: bing.com
Addresses: xxxx:xxx:xxx::xxx
xx.xxx.xx.xxx
xxx.xx.xxx.xx
</pre></td></tr></tbody></table></code></div></div>

<h2 id="setup-server"><span class="me-2">Setup server</span><a href="#setup-server" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>What we need is a server with public <strong><em>IPv4</em></strong> address and Linux installed (Debian recommended).</p>

<div class="language-shell highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>root@debian:~# <span class="nb">uname</span> <span class="nt">-a</span>
Linux debian 6.1.0-23-amd64 <span class="c">#1 SMP PREEMPT_DYNAMIC Debian 6.1.99-1 (2024-07-</span>
15<span class="o">)</span> x86_64 GNU/Linux
</pre></td></tr></tbody></table></code></div></div>

<h3 id="compile-server"><span class="me-2">Compile server</span><a href="#compile-server" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p><code class="language-plaintext highlighter-rouge">cd</code> to the directory where you want to store the source code, then <code class="language-plaintext highlighter-rouge">./configure</code> to comnfigure the package for your system. Running it takes a while.
<code class="language-plaintext highlighter-rouge">make</code> to compile the package. Optionally, type <code class="language-plaintext highlighter-rouge">make check</code> to run any self-tests that come with the package.
<code class="language-plaintext highlighter-rouge">make install</code> to install the programs and any data files and documentation.</p>

<h3 id="configure-server"><span class="me-2">Configure server</span><a href="#configure-server" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>After installing, create a config file <code class="language-plaintext highlighter-rouge">/etc/dns2tcpd.conf</code></p>

<div class="language-shell highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>root@debian:~# <span class="nb">cat</span> /etc/dns2tcpd.conf
listen <span class="o">=</span> 0.0.0.0
port <span class="o">=</span> 53
user <span class="o">=</span> nobody
<span class="nb">chroot</span> <span class="o">=</span> /tmp
domain <span class="o">=</span> ns.xxxxx.com   <span class="c"># an NS record whose value is A record's second-level domain name</span>
resources <span class="o">=</span> ssh:127.0.0.1:22
</pre></td></tr></tbody></table></code></div></div>

<h2 id="setup-client"><span class="me-2">Setup client</span><a href="#setup-client" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="complie-client"><span class="me-2">Complie client</span><a href="#complie-client" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>In Windows, you can use the compiled <code class="language-plaintext highlighter-rouge">.exe</code> file.
<a href="https://github.com/the0cp/dns2tcp">https://github.com/the0cp/dns2tcp</a></p>

<h3 id="run-client"><span class="me-2">Run client</span><a href="#run-client" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Connect the server with following command, the listening port will be 8888 (It may conflict with some capture services and can be changed to other available ports like 8887 etc.):</p>

<div class="language-shell highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>dns2tcpc <span class="nt">-r</span> ssh <span class="nt">-z</span> &lt;ns.xxxx.com&gt; &lt;ip&gt; <span class="nt">-l</span> 8888
</pre></td></tr></tbody></table></code></div></div>

<h2 id="connect-the-server"><span class="me-2">Connect the server</span><a href="#connect-the-server" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Install and configure <code class="language-plaintext highlighter-rouge">ssh</code> on the client. Then establish a connection with <code class="language-plaintext highlighter-rouge">127.0.0.1:8888</code>. On my server, I use <code class="language-plaintext highlighter-rouge">root</code> to log in. You can use tools such as <strong><em>puTTY</em></strong> to establish connection and store profiles more conveniently.</p>

<p>Port forwarding can be set up to forward <code class="language-plaintext highlighter-rouge">127.0.0.1:22</code> to <code class="language-plaintext highlighter-rouge">127.0.0.1:10809</code> (for example) as a SOCKS proxy. Manually add a <code class="language-plaintext highlighter-rouge">SOCKS v5</code> in browsers (e.g. <strong><em>Firefox</em></strong>) to use the proxy.</p>

<blockquote class="prompt-tip">
  <p>Of course, you can also use other proxy tools for Global Proxying. (such as <strong><em>Proxifier</em></strong>, <strong><em>proxychains</em></strong> etc.)</p>
</blockquote>

<h2 id="connect-automatically"><span class="me-2">Connect automatically</span><a href="#connect-automatically" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<blockquote class="prompt-tip">
  <p>For convenience, automated scripts can be developed to achieve functions such as automatic reconnection.</p>
</blockquote>

<p>I use <strong><em>Golang</em></strong> to develop. As a simple example, part of the source code is as follows:</p>

<div class="language-go highlighter-rouge"><div class="code-header">
        <span data-label-text="Go"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
</pre></td><td class="rouge-code"><pre><span class="c">/*
main.go
*/</span>
<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">go</span> <span class="n">systray</span><span class="o">.</span><span class="n">Run</span><span class="p">(</span><span class="n">onReady</span><span class="p">,</span> <span class="n">onExit</span><span class="p">)</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">banner</span><span class="o">.</span><span class="n">Inline</span><span class="p">(</span><span class="s">"dnssh"</span><span class="p">))</span>
	<span class="n">s</span> <span class="o">:=</span> <span class="n">spinner</span><span class="o">.</span><span class="n">New</span><span class="p">(</span><span class="n">spinner</span><span class="o">.</span><span class="n">CharSets</span><span class="p">[</span><span class="m">9</span><span class="p">],</span> <span class="m">100</span><span class="o">*</span><span class="n">time</span><span class="o">.</span><span class="n">Millisecond</span><span class="p">)</span>
	<span class="c">// Build new spinner</span>
	<span class="n">s</span><span class="o">.</span><span class="n">Start</span><span class="p">()</span> 	<span class="c">// Start the spinner</span>
	<span class="n">pause</span><span class="p">()</span>
	<span class="n">s</span><span class="o">.</span><span class="n">Stop</span><span class="p">()</span>
	<span class="n">cmd</span> <span class="o">:=</span> <span class="n">exec</span><span class="o">.</span><span class="n">Command</span><span class="p">(</span><span class="s">"cmd.exe"</span><span class="p">,</span> <span class="s">"/c"</span><span class="p">,</span> <span class="s">"dns2tcpc.exe -r ssh -z mc.xxxx.com
	000.00.00.00 -l 8888 -d 2"</span><span class="p">)</span>

	<span class="n">console</span><span class="o">.</span><span class="n">Debug</span><span class="p">(</span><span class="s">"Opening dns tunnel..."</span><span class="p">)</span>

	<span class="k">go</span> <span class="n">cmd</span><span class="o">.</span><span class="n">Start</span><span class="p">()</span>
	<span class="n">console</span><span class="o">.</span><span class="n">Debug</span><span class="p">(</span><span class="s">"Start Connecting through SSH..."</span><span class="p">)</span>
	<span class="k">var</span> <span class="n">auths</span> <span class="p">[]</span><span class="n">ssh</span><span class="o">.</span><span class="n">AuthMethod</span>

	<span class="k">if</span> <span class="o">*</span><span class="n">PASS</span> <span class="o">!=</span> <span class="s">""</span> <span class="p">{</span>
		<span class="n">auths</span> <span class="o">=</span> <span class="nb">append</span><span class="p">(</span><span class="n">auths</span><span class="p">,</span> <span class="n">ssh</span><span class="o">.</span><span class="n">Password</span><span class="p">(</span><span class="o">*</span><span class="n">PASS</span><span class="p">))</span>
	<span class="p">}</span>

	<span class="n">config</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="n">ssh</span><span class="o">.</span><span class="n">ClientConfig</span><span class="p">{</span>
		<span class="n">User</span><span class="o">:</span> 			 	<span class="o">*</span><span class="n">USER</span><span class="p">,</span>
		<span class="n">Auth</span><span class="o">:</span> 			 	<span class="n">auths</span><span class="p">,</span>
		<span class="n">HostKeyCallback</span><span class="o">:</span> 	<span class="n">ssh</span><span class="o">.</span><span class="n">InsecureIgnoreHostKey</span><span class="p">(),</span>
	<span class="p">}</span>

	<span class="n">addr</span> <span class="o">:=</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Sprintf</span><span class="p">(</span><span class="s">"%s:%d"</span><span class="p">,</span> <span class="o">*</span><span class="n">HOST</span><span class="p">,</span> <span class="m">8888</span><span class="p">)</span>
	<span class="n">conn</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">ssh</span><span class="o">.</span><span class="n">Dial</span><span class="p">(</span><span class="s">"tcp"</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>

	<span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
		<span class="n">console</span><span class="o">.</span><span class="n">Warn</span><span class="p">(</span><span class="s">"unable to connect to [%s]: %v"</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
	<span class="p">}</span>

	<span class="k">defer</span> <span class="n">conn</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span>
	<span class="n">addr</span> <span class="o">=</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Sprintf</span><span class="p">(</span><span class="s">"%s:%d"</span><span class="p">,</span> <span class="s">"127.0.0.1"</span><span class="p">,</span> <span class="o">*</span><span class="n">PORT</span><span class="p">)</span>
	<span class="n">l</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">net</span><span class="o">.</span><span class="n">Listen</span><span class="p">(</span><span class="s">"tcp"</span><span class="p">,</span> <span class="n">addr</span><span class="p">)</span>
	
	<span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
		<span class="n">console</span><span class="o">.</span><span class="n">Warn</span><span class="p">(</span><span class="s">"unable to listen on SOCKS port [%s]: %v"</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
	<span class="p">}</span>

	<span class="k">defer</span> <span class="n">l</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span>
	<span class="n">console</span><span class="o">.</span><span class="n">Debug</span><span class="p">(</span><span class="s">"listening for incoming SOCKS connections on [%s]</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">addr</span><span class="p">)</span>
	
	<span class="k">for</span> <span class="p">{</span>
		<span class="n">c</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">l</span><span class="o">.</span><span class="n">Accept</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
			<span class="n">console</span><span class="o">.</span><span class="n">Warn</span><span class="p">(</span><span class="s">"failed to accept incoming SOCKS connection: %v"</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
		<span class="p">}</span>
		<span class="k">go</span> <span class="n">handleConn</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="p">(</span><span class="o">*</span><span class="n">net</span><span class="o">.</span><span class="n">TCPConn</span><span class="p">),</span> <span class="n">conn</span><span class="p">)</span>
	<span class="p">}</span>

	<span class="n">log</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"waiting for all existing connections to finish"</span><span class="p">)</span>
	<span class="n">connections</span><span class="o">.</span><span class="n">Wait</span><span class="p">()</span>
	<span class="n">log</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"shutting down"</span><span class="p">)</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<div class="language-go highlighter-rouge"><div class="code-header">
        <span data-label-text="Go"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
</pre></td><td class="rouge-code"><pre><span class="k">func</span> <span class="n">handleConn</span><span class="p">(</span><span class="n">local</span> <span class="o">*</span><span class="n">net</span><span class="o">.</span><span class="n">TCPConn</span><span class="p">,</span> <span class="n">dialer</span> <span class="n">Dialer</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">connections</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
	<span class="k">defer</span> <span class="n">local</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span>
	<span class="k">defer</span> <span class="n">connections</span><span class="o">.</span><span class="n">Done</span><span class="p">()</span>
	
	<span class="c">// SOCKS does not include a length in the header, so take</span>
	<span class="c">// a punt that each request will be readable in one go.</span>

	<span class="n">buf</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([]</span><span class="kt">byte</span><span class="p">,</span> <span class="m">256</span><span class="p">)</span>
	<span class="n">n</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">local</span><span class="o">.</span><span class="n">Read</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span>

	<span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="o">||</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="m">2</span> <span class="p">{</span>
		<span class="n">log</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"[%s] unable to read SOCKS header: %v"</span><span class="p">,</span> <span class="n">local</span><span class="o">.</span><span class="n">RemoteAddr</span><span class="p">(),</span> <span class="n">err</span><span class="p">)</span>
		<span class="k">return</span>
	<span class="p">}</span>

	<span class="n">buf</span> <span class="o">=</span> <span class="n">buf</span><span class="p">[</span><span class="o">:</span><span class="n">n</span><span class="p">]</span>
	<span class="k">switch</span> <span class="n">version</span> <span class="o">:=</span> <span class="n">buf</span><span class="p">[</span><span class="m">0</span><span class="p">];</span> <span class="n">version</span> <span class="p">{</span>
		<span class="k">case</span> <span class="m">4</span><span class="o">:</span>
		<span class="k">switch</span> <span class="n">command</span> <span class="o">:=</span> <span class="n">buf</span><span class="p">[</span><span class="m">1</span><span class="p">];</span> <span class="n">command</span> <span class="p">{</span>
		<span class="k">case</span> <span class="m">1</span><span class="o">:</span>
			<span class="n">port</span> <span class="o">:=</span> <span class="n">binary</span><span class="o">.</span><span class="n">BigEndian</span><span class="o">.</span><span class="n">Uint16</span><span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="m">2</span><span class="o">:</span><span class="m">4</span><span class="p">])</span>
			<span class="n">ip</span> <span class="o">:=</span> <span class="n">net</span><span class="o">.</span><span class="n">IP</span><span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="m">4</span><span class="o">:</span><span class="m">8</span><span class="p">])</span>
			<span class="n">addr</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="n">net</span><span class="o">.</span><span class="n">TCPAddr</span><span class="p">{</span><span class="n">IP</span><span class="o">:</span> <span class="n">ip</span><span class="p">,</span> <span class="n">Port</span><span class="o">:</span> <span class="kt">int</span><span class="p">(</span><span class="n">port</span><span class="p">)}</span>
			<span class="n">buf</span> <span class="o">:=</span> <span class="n">buf</span><span class="p">[</span><span class="m">8</span><span class="o">:</span><span class="p">]</span>
			<span class="n">i</span> <span class="o">:=</span> <span class="n">bytes</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">{</span><span class="m">0</span><span class="p">})</span>
			<span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="m">0</span> <span class="p">{</span>
				<span class="n">log</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"[%s] unable to locate SOCKS4 user"</span><span class="p">,</span> <span class="n">local</span><span class="o">.</span><span class="n">RemoteAddr</span><span class="p">())</span>
				<span class="k">return</span>
			<span class="p">}</span>
			<span class="n">user</span> <span class="o">:=</span> <span class="n">buf</span><span class="p">[</span><span class="o">:</span><span class="n">i</span><span class="p">]</span>
			<span class="n">log</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"[%s] incoming SOCKS4 TCP/IP stream connection, user=%q, raddr=%s"</span><span class="p">,</span> <span class="n">local</span><span class="o">.</span><span class="n">RemoteAddr</span><span class="p">(),</span> <span class="n">user</span><span class="p">,</span> <span class="n">addr</span><span class="p">)</span>
			<span class="n">remote</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">dialer</span><span class="o">.</span><span class="n">DialTCP</span><span class="p">(</span><span class="s">"tcp4"</span><span class="p">,</span> <span class="n">local</span><span class="o">.</span><span class="n">RemoteAddr</span><span class="p">()</span><span class="o">.</span><span class="p">(</span><span class="o">*</span><span class="n">net</span><span class="o">.</span><span class="n">TCPAddr</span><span class="p">),</span> <span class="n">addr</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
				<span class="n">log</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"[%s] unable to connect to remote host: %v"</span><span class="p">,</span> <span class="n">local</span><span class="o">.</span><span class="n">RemoteAddr</span><span class="p">(),</span> <span class="n">err</span><span class="p">)</span>
				<span class="n">local</span><span class="o">.</span><span class="n">Write</span><span class="p">([]</span><span class="kt">byte</span><span class="p">{</span><span class="m">0</span><span class="p">,</span> <span class="m">0x5b</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">})</span>
				<span class="k">return</span>
			<span class="p">}</span>
			<span class="n">local</span><span class="o">.</span><span class="n">Write</span><span class="p">([]</span><span class="kt">byte</span><span class="p">{</span><span class="m">0</span><span class="p">,</span> <span class="m">0x5a</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">})</span>
			<span class="n">transfer</span><span class="p">(</span><span class="n">local</span><span class="p">,</span> <span class="n">remote</span><span class="p">)</span>
		<span class="k">default</span><span class="o">:</span>
			<span class="n">log</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"[%s] unsupported command, closing connection"</span><span class="p">,</span> <span class="n">local</span><span class="o">.</span><span class="n">RemoteAddr</span><span class="p">())</span>
	<span class="p">}</span>

		<span class="k">case</span> <span class="m">5</span><span class="o">:</span>
			<span class="n">authlen</span><span class="p">,</span> <span class="n">buf</span> <span class="o">:=</span> <span class="n">buf</span><span class="p">[</span><span class="m">1</span><span class="p">],</span> <span class="n">buf</span><span class="p">[</span><span class="m">2</span><span class="o">:</span><span class="p">]</span>
			<span class="n">auths</span><span class="p">,</span> <span class="n">buf</span> <span class="o">:=</span> <span class="n">buf</span><span class="p">[</span><span class="o">:</span><span class="n">authlen</span><span class="p">],</span> <span class="n">buf</span><span class="p">[</span><span class="n">authlen</span><span class="o">:</span><span class="p">]</span>
			<span class="k">if</span> <span class="o">!</span><span class="n">bytes</span><span class="o">.</span><span class="n">Contains</span><span class="p">(</span><span class="n">auths</span><span class="p">,</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">{</span><span class="m">0</span><span class="p">})</span> <span class="p">{</span>
				<span class="n">log</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"[%s] unsuported SOCKS5 authentication method"</span><span class="p">,</span> <span class="n">local</span><span class="o">.</span><span class="n">RemoteAddr</span><span class="p">())</span>
				<span class="n">local</span><span class="o">.</span><span class="n">Write</span><span class="p">([]</span><span class="kt">byte</span><span class="p">{</span><span class="m">0x05</span><span class="p">,</span> <span class="m">0xff</span><span class="p">})</span>
				<span class="k">return</span>
			<span class="p">}</span>

			<span class="n">local</span><span class="o">.</span><span class="n">Write</span><span class="p">([]</span><span class="kt">byte</span><span class="p">{</span><span class="m">0x05</span><span class="p">,</span> <span class="m">0x00</span><span class="p">})</span>
			<span class="n">buf</span> <span class="o">=</span> <span class="nb">make</span><span class="p">([]</span><span class="kt">byte</span><span class="p">,</span> <span class="m">256</span><span class="p">)</span>
			<span class="n">n</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">local</span><span class="o">.</span><span class="n">Read</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span>

			<span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
				<span class="n">log</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"[%s] unable to read SOCKS header: %v"</span><span class="p">,</span> <span class="n">local</span><span class="o">.</span><span class="n">RemoteAddr</span><span class="p">(),</span> <span class="n">err</span><span class="p">)</span>
				<span class="k">return</span>
			<span class="p">}</span>
		<span class="n">buf</span> <span class="o">=</span> <span class="n">buf</span><span class="p">[</span><span class="o">:</span><span class="n">n</span><span class="p">]</span>
		<span class="k">switch</span> <span class="n">version</span> <span class="o">:=</span> <span class="n">buf</span><span class="p">[</span><span class="m">0</span><span class="p">];</span> <span class="n">version</span> <span class="p">{</span>
		<span class="k">case</span> <span class="m">5</span><span class="o">:</span>
		<span class="k">switch</span> <span class="n">command</span> <span class="o">:=</span> <span class="n">buf</span><span class="p">[</span><span class="m">1</span><span class="p">];</span> <span class="n">command</span> <span class="p">{</span>
		<span class="k">case</span> <span class="m">1</span><span class="o">:</span>
		<span class="n">buf</span> <span class="o">=</span> <span class="n">buf</span><span class="p">[</span><span class="m">3</span><span class="o">:</span><span class="p">]</span>
		<span class="k">switch</span> <span class="n">addrtype</span> <span class="o">:=</span> <span class="n">buf</span><span class="p">[</span><span class="m">0</span><span class="p">];</span> <span class="n">addrtype</span> <span class="p">{</span>
		<span class="k">case</span> <span class="m">1</span><span class="o">:</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span> <span class="o">&lt;</span> <span class="m">8</span> <span class="p">{</span>
				<span class="n">log</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"[%s] corrupt SOCKS5 TCP/IP stream connection request"</span><span class="p">,</span> <span class="n">local</span><span class="o">.</span><span class="n">RemoteAddr</span><span class="p">())</span>
				<span class="n">local</span><span class="o">.</span><span class="n">Write</span><span class="p">([]</span><span class="kt">byte</span><span class="p">{</span><span class="m">0x05</span><span class="p">,</span> <span class="m">0x07</span><span class="p">,</span> <span class="m">0x00</span><span class="p">,</span> <span class="m">0x01</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">})</span>
				<span class="k">return</span>
			<span class="p">}</span>

		<span class="n">ip</span> <span class="o">:=</span> <span class="n">net</span><span class="o">.</span><span class="n">IP</span><span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">])</span>
		<span class="n">port</span> <span class="o">:=</span> <span class="n">binary</span><span class="o">.</span><span class="n">BigEndian</span><span class="o">.</span><span class="n">Uint16</span><span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="m">5</span><span class="o">:</span><span class="m">6</span><span class="p">])</span>
		<span class="n">addr</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="n">net</span><span class="o">.</span><span class="n">TCPAddr</span><span class="p">{</span><span class="n">IP</span><span class="o">:</span> <span class="n">ip</span><span class="p">,</span> <span class="n">Port</span><span class="o">:</span> <span class="kt">int</span><span class="p">(</span><span class="n">port</span><span class="p">)}</span>
		<span class="n">log</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"[%s] incoming SOCKS5 TCP/IP stream connection, raddr=%s"</span><span class="p">,</span> <span class="n">local</span><span class="o">.</span><span class="n">RemoteAddr</span><span class="p">(),</span> <span class="n">addr</span><span class="p">)</span>
		<span class="n">remote</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">dialer</span><span class="o">.</span><span class="n">DialTCP</span><span class="p">(</span><span class="s">"tcp"</span><span class="p">,</span> <span class="n">local</span><span class="o">.</span><span class="n">RemoteAddr</span><span class="p">()</span><span class="o">.</span><span class="p">(</span><span class="o">*</span><span class="n">net</span><span class="o">.</span><span class="n">TCPAddr</span><span class="p">),</span> <span class="n">addr</span><span class="p">)</span>

		<span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
			<span class="n">log</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"[%s] unable to connect to remote host: %v"</span><span class="p">,</span> <span class="n">local</span><span class="o">.</span><span class="n">RemoteAddr</span><span class="p">(),</span> <span class="n">err</span><span class="p">)</span>
			<span class="n">local</span><span class="o">.</span><span class="n">Write</span><span class="p">([]</span><span class="kt">byte</span><span class="p">{</span><span class="m">0x05</span><span class="p">,</span> <span class="m">0x04</span><span class="p">,</span> <span class="m">0x00</span><span class="p">,</span> <span class="m">0x01</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">})</span>
			<span class="k">return</span>
		<span class="p">}</span>
		<span class="n">local</span><span class="o">.</span><span class="n">Write</span><span class="p">([]</span><span class="kt">byte</span><span class="p">{</span><span class="m">0x05</span><span class="p">,</span> <span class="m">0x00</span><span class="p">,</span> <span class="m">0x00</span><span class="p">,</span> <span class="m">0x01</span><span class="p">,</span> <span class="n">ip</span><span class="p">[</span><span class="m">0</span><span class="p">],</span> <span class="n">ip</span><span class="p">[</span><span class="m">1</span><span class="p">],</span> <span class="n">ip</span><span class="p">[</span><span class="m">2</span><span class="p">],</span> <span class="n">ip</span><span class="p">[</span><span class="m">3</span><span class="p">],</span> <span class="kt">byte</span><span class="p">(</span><span class="n">port</span> <span class="o">&gt;&gt;</span> <span class="m">8</span><span class="p">),</span> <span class="kt">byte</span><span class="p">(</span><span class="n">port</span><span class="p">)})</span>
		<span class="n">transfer</span><span class="p">(</span><span class="n">local</span><span class="p">,</span> <span class="n">remote</span><span class="p">)</span>

		<span class="k">case</span> <span class="m">3</span><span class="o">:</span>
			<span class="n">addrlen</span><span class="p">,</span> <span class="n">buf</span> <span class="o">:=</span> <span class="n">buf</span><span class="p">[</span><span class="m">1</span><span class="p">],</span> <span class="n">buf</span><span class="p">[</span><span class="m">2</span><span class="o">:</span><span class="p">]</span>
			<span class="n">name</span><span class="p">,</span> <span class="n">buf</span> <span class="o">:=</span> <span class="n">buf</span><span class="p">[</span><span class="o">:</span><span class="n">addrlen</span><span class="p">],</span> <span class="n">buf</span><span class="p">[</span><span class="n">addrlen</span><span class="o">:</span><span class="p">]</span>
			<span class="n">ip</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">net</span><span class="o">.</span><span class="n">ResolveIPAddr</span><span class="p">(</span><span class="s">"ip"</span><span class="p">,</span> <span class="kt">string</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
			<span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
				<span class="n">log</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"[%s] unable to resolve IP address: %q, %v"</span><span class="p">,</span> <span class="n">local</span><span class="o">.</span><span class="n">RemoteAddr</span><span class="p">(),</span> <span class="n">name</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
				<span class="n">local</span><span class="o">.</span><span class="n">Write</span><span class="p">([]</span><span class="kt">byte</span><span class="p">{</span><span class="m">0x05</span><span class="p">,</span> <span class="m">0x04</span><span class="p">,</span> <span class="m">0x00</span><span class="p">,</span> <span class="m">0x01</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">})</span>
				<span class="k">return</span>
			<span class="p">}</span>

			<span class="n">port</span> <span class="o">:=</span> <span class="n">binary</span><span class="o">.</span><span class="n">BigEndian</span><span class="o">.</span><span class="n">Uint16</span><span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="o">:</span><span class="m">2</span><span class="p">])</span>
			<span class="n">addr</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="n">net</span><span class="o">.</span><span class="n">TCPAddr</span><span class="p">{</span><span class="n">IP</span><span class="o">:</span> <span class="n">ip</span><span class="o">.</span><span class="n">IP</span><span class="p">,</span> <span class="n">Port</span><span class="o">:</span> <span class="kt">int</span><span class="p">(</span><span class="n">port</span><span class="p">)}</span>
			<span class="n">remote</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">dialer</span><span class="o">.</span><span class="n">DialTCP</span><span class="p">(</span><span class="s">"tcp"</span><span class="p">,</span> <span class="n">local</span><span class="o">.</span><span class="n">RemoteAddr</span><span class="p">()</span><span class="o">.</span><span class="p">(</span><span class="o">*</span><span class="n">net</span><span class="o">.</span><span class="n">TCPAddr</span><span class="p">),</span> <span class="n">addr</span><span class="p">)</span>

			<span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
				<span class="n">log</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"[%s] unable to connect to remote host: %v"</span><span class="p">,</span> <span class="n">local</span><span class="o">.</span><span class="n">RemoteAddr</span><span class="p">(),</span> <span class="n">err</span><span class="p">)</span>
				<span class="n">local</span><span class="o">.</span><span class="n">Write</span><span class="p">([]</span><span class="kt">byte</span><span class="p">{</span><span class="m">0x05</span><span class="p">,</span> <span class="m">0x04</span><span class="p">,</span> <span class="m">0x00</span><span class="p">,</span> <span class="m">0x01</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">})</span>
				<span class="k">return</span>
			<span class="p">}</span>
			<span class="n">local</span><span class="o">.</span><span class="n">Write</span><span class="p">([]</span><span class="kt">byte</span><span class="p">{</span><span class="m">0x05</span><span class="p">,</span> <span class="m">0x00</span><span class="p">,</span> <span class="m">0x00</span><span class="p">,</span> <span class="m">0x01</span><span class="p">,</span> <span class="n">addr</span><span class="o">.</span><span class="n">IP</span><span class="p">[</span><span class="m">0</span><span class="p">],</span> <span class="n">addr</span><span class="o">.</span><span class="n">IP</span><span class="p">[</span><span class="m">1</span><span class="p">],</span> <span class="n">addr</span><span class="o">.</span><span class="n">IP</span><span class="p">[</span><span class="m">2</span><span class="p">],</span> <span class="n">addr</span><span class="o">.</span><span class="n">IP</span><span class="p">[</span><span class="m">3</span><span class="p">],</span> <span class="kt">byte</span><span class="p">(</span><span class="n">port</span> <span class="o">&gt;&gt;</span> <span class="m">8</span><span class="p">),</span> <span class="kt">byte</span><span class="p">(</span><span class="n">port</span><span class="p">)})</span>
			<span class="n">transfer</span><span class="p">(</span><span class="n">local</span><span class="p">,</span> <span class="n">remote</span><span class="p">)</span>
		<span class="k">default</span><span class="o">:</span>
			<span class="n">log</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"[%s] unsupported SOCKS5 address type: %d"</span><span class="p">,</span> <span class="n">local</span><span class="o">.</span><span class="n">RemoteAddr</span><span class="p">(),</span> <span class="n">addrtype</span><span class="p">)</span>
			<span class="n">local</span><span class="o">.</span><span class="n">Write</span><span class="p">([]</span><span class="kt">byte</span><span class="p">{</span><span class="m">0x05</span><span class="p">,</span> <span class="m">0x08</span><span class="p">,</span> <span class="m">0x00</span><span class="p">,</span> <span class="m">0x01</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">})</span>
	<span class="p">}</span>
		<span class="k">default</span><span class="o">:</span>
			<span class="n">log</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"[%s] unknown SOCKS5 command: %d"</span><span class="p">,</span> <span class="n">local</span><span class="o">.</span><span class="n">RemoteAddr</span><span class="p">(),</span> <span class="n">command</span><span class="p">)</span>
			<span class="n">local</span><span class="o">.</span><span class="n">Write</span><span class="p">([]</span><span class="kt">byte</span><span class="p">{</span><span class="m">0x05</span><span class="p">,</span> <span class="m">0x07</span><span class="p">,</span> <span class="m">0x00</span><span class="p">,</span> <span class="m">0x01</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">})</span>
	<span class="p">}</span>
			<span class="k">default</span><span class="o">:</span>
				<span class="n">log</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"[%s] unnknown version after SOCKS5 handshake: %d"</span><span class="p">,</span> <span class="n">local</span><span class="o">.</span><span class="n">RemoteAddr</span><span class="p">(),</span> <span class="n">version</span><span class="p">)</span>
				<span class="n">local</span><span class="o">.</span><span class="n">Write</span><span class="p">([]</span><span class="kt">byte</span><span class="p">{</span><span class="m">0x05</span><span class="p">,</span> <span class="m">0x07</span><span class="p">,</span> <span class="m">0x00</span><span class="p">,</span> <span class="m">0x01</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">})</span>
		<span class="p">}</span>
	<span class="k">default</span><span class="o">:</span>
		<span class="n">log</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"[%s] unknown SOCKS version: %d"</span><span class="p">,</span> <span class="n">local</span><span class="o">.</span><span class="n">RemoteAddr</span><span class="p">(),</span> <span class="n">version</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="how-to-defense"><span class="me-2">How to defense</span><a href="#how-to-defense" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<blockquote class="prompt-warning">
  <p>Ensuring that there is no unrestricted inbound access to UDP port 53 is critical in protecting your DNS server from unauthorized access and potential attacks. UDP port 53 is used by the DNS protocol to resolve domain names to IP addresses and vice versa. If it is left open and unrestricted, it can be exploited by attackers to redirect users to malicious websites, intercept sensitive information or launch DDoS attacks.</p>
</blockquote>

<h3 id="tips"><span class="me-2">Tips:</span><a href="#tips" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>There are several ways to defend against DNS tunnel bypass vulnerabilities. Here are some suggestions:</p>

<ul>
  <li>Understand the risks of exposed port 53 and DNS Security.</li>
  <li>Prevent users from frequently querying DNS.</li>
  <li>Setting up and managing your own private DNS servers</li>
  <li>Disable external DNS requests and only allow trusted DNS server query requests.</li>
  <li>Traffic inspection, different DNS tunnels have different traffic characteristics, and most of these kind of traffic can be intercepted.</li>
  <li>Educating employees about the risks and signs of DNS tunneling attacks.</li>
</ul>

<h3 id="monitoring-utilities"><span class="me-2">Monitoring Utilities</span><a href="#monitoring-utilities" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Below are some utilities that are useful for detecting tunneling attacks:</p>

<ul>
  <li>
    <p><a href="https://hunttools.gitbooks.io/mercenary-linux/content/dnshunter_module.html">dnsHunter</a>: A Python module written for MercenaryHuntFramework &amp; Mercenary-Linux.  <br />
       Reads .pcap files to extract DNS queries and performs geo-lookups, which helps in analyses.</p>
  </li>
  <li>
    <p><a href="https://www.vs.uni-due.de/wander/reassemble_dns/">reassemble_dns</a>: A Python tool to read .pcap files and reassemble DNS messages.</p>
  </li>
</ul>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/linux/">Linux</a>,
          <a href="/categories/pentest/">Pentest</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/linux/"
            class="post-tag no-text-decoration"
          >Linux</a>
        
          <a
            href="/tags/pentest/"
            class="post-tag no-text-decoration"
          >Pentest</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=Bypass%20the%20Network%20Authentication%20with%20DNS%20Tunnelling%20-%20Blog%20%7C%20the0cp&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fdns%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=Bypass%20the%20Network%20Authentication%20with%20DNS%20Tunnelling%20-%20Blog%20%7C%20the0cp&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fdns%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fdns%2F&text=Bypass%20the%20Network%20Authentication%20with%20DNS%20Tunnelling%20-%20Blog%20%7C%20the0cp" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

      

      <a href="https://www.reddit.com/submit?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fdns%2F&title=Bypass%20the%20Network%20Authentication%20with%20DNS%20Tunnelling%20-%20Blog%20%7C%20the0cp" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Reddit" aria-label="Reddit">
        <i class="fa-fw fa-brands fa-square-reddit"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/aseprite/">Automatically build Aseprite with Github Actions</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/vserial/">Create Virtual Serial Port in Linux</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/dns/">Bypass the Network Authentication with DNS Tunnelling</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/mdk3/">Perform selective jamming of Wi-Fi networks and clients with mdk3(DoS attack on APs/clients)</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/telegram/">Is Telegram really anonymous & "focus on privacy" as it advertises? IM software comparison</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/linux/">Linux</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/pentest/">Pentest</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/c-c/">C/C++</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/beautify/">Beautify</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/github/">Github</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/qt/">Qt</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/blogging/">blogging</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/c/">c++</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/c/">c</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/hexo/">hexo</a>
      
    </div>
  </section>


            </div>

            
              
              






  <section id="toc-wrapper" class="ps-0 pe-4">
    <h2 class="panel-heading ps-3 mb-2">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/mdk3/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1637334000"
  data-df="ll"
  
>
  Nov 20, 2021
</time>

              <h4 class="pt-0 my-2">Perform selective jamming of Wi-Fi networks and clients with mdk3(DoS attack on APs/clients)</h4>
              <div class="text-muted">
                <p>*mdk3* is used for **stress testing 802.11 networks(wifi)**. It consists of various methods by which we can perform tests. Some of major method sare beacon flooding, deauthentication, WPA-dos etc...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/arp-spoofing/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1612969200"
  data-df="ll"
  
>
  Feb 11, 2021
</time>

              <h4 class="pt-0 my-2">Penetration Testing | ARP Spoofing(Poisoning) in the internal network & How to prevent it</h4>
              <div class="text-muted">
                <p>ARP spoofing is a type of attack in which a malicious actor sends falsified ARP messages over a local area network. We use Kali/Parrot Linux to make a simple ARP Spoofing.</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/new-conky/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1611846000"
  data-df="ll"
  
>
  Jan 29, 2021
</time>

              <h4 class="pt-0 my-2">Syntax Error | Conky syntax update</h4>
              <div class="text-muted">
                <p>Conky has changed its syntax, and new configure file should be written.</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/mdk3/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>Perform selective jamming of Wi-Fi networks and clients with mdk3(DoS attack on APs/clients)</p>
    </a>
  

  
    <a
      href="/posts/aseprite/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>Automatically build Aseprite with Github Actions</p>
    </a>
  
</nav>

            
              
              <!-- The comments switcher -->


            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>Â©
    <time>2024</time>

    
      <!--<a href="https://twitter.com/T_Ccooper">Theodore Cooper</a>.-->
      Theodore Cooper.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >
      <!--All rights reserved.-->
      </span>
    
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/linux/">Linux</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/pentest/">Pentest</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/c-c/">C/C++</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/beautify/">Beautify</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/github/">Github</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/qt/">Qt</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/blogging/">blogging</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/c/">c++</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/c/">c</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/hexo/">hexo</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->
    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.29.0/dist/tocbot.min.js"></script>







<script src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  







    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5">Oops! No results found.</p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

