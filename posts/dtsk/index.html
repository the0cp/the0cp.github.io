<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" data-mode="dark">
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  >
  <!-- Start cookieyes banner --> 
  <script id="cookieyes" type="text/javascript" src="https://cdn-cookieyes.com/client_data/4a234529adfe7f29612c0be5/script.js"></script> 
  <!-- End cookieyes banner -->

  <!-- Global site tag (gtag.js) - Google Analytics -->
<script defer src="https://www.googletagmanager.com/gtag/js?id=G-SLEGY5RRPL"></script>
<script>
  document.addEventListener('DOMContentLoaded', function (event) {
    window.dataLayer = window.dataLayer || [];
    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', 'G-SLEGY5RRPL');
  });
</script>
<!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="Deconstructing the Deep TSK Fuzzy Classifier with Stacked Generalization" />
<meta name="author" content="Theodore Cooper" />
<meta property="og:locale" content="en" />
<meta name="description" content="A detailed technical analysis of the Deep Takagi-Sugeno-Kang Fuzzy Classifier (D-TSK-FC), a novel machine learning model designed to achieve both high performance and clear interpretability. This article breaks down the model‚Äôs unique stacked architecture, its layer-by-layer training algorithm based on the Least Learning Machine (LLM), and the core principles that guarantee its ‚Äútriplely concise interpretability.‚Äù" />
<meta property="og:description" content="A detailed technical analysis of the Deep Takagi-Sugeno-Kang Fuzzy Classifier (D-TSK-FC), a novel machine learning model designed to achieve both high performance and clear interpretability. This article breaks down the model‚Äôs unique stacked architecture, its layer-by-layer training algorithm based on the Least Learning Machine (LLM), and the core principles that guarantee its ‚Äútriplely concise interpretability.‚Äù" />
<link rel="canonical" href="https://the0cp.cc/posts/dtsk/" />
<meta property="og:url" content="https://the0cp.cc/posts/dtsk/" />
<meta property="og:site_name" content="the0cp" />
<meta property="og:image" content="https://the0cp.cc/assets/img/blog/dtsk/cover.webp" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-07-12T00:00:00+09:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://the0cp.cc/assets/img/blog/dtsk/cover.webp" />
<meta property="twitter:title" content="Deconstructing the Deep TSK Fuzzy Classifier with Stacked Generalization" />
<meta name="twitter:site" content="@T_Ccooper" />
<meta name="twitter:creator" content="@T_Ccooper" />
<meta name="yandex-verification" content="41dbd09c93221b0e" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Theodore Cooper","url":"https://github.com/the0cp/"},"dateModified":"2025-07-12T00:00:00+09:00","datePublished":"2025-07-12T00:00:00+09:00","description":"A detailed technical analysis of the Deep Takagi-Sugeno-Kang Fuzzy Classifier (D-TSK-FC), a novel machine learning model designed to achieve both high performance and clear interpretability. This article breaks down the model‚Äôs unique stacked architecture, its layer-by-layer training algorithm based on the Least Learning Machine (LLM), and the core principles that guarantee its ‚Äútriplely concise interpretability.‚Äù","headline":"Deconstructing the Deep TSK Fuzzy Classifier with Stacked Generalization","image":{"lqip":"/assets/img/placeholder.webp","url":"https://the0cp.cc/assets/img/blog/dtsk/cover.webp","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://the0cp.cc/posts/dtsk/"},"url":"https://the0cp.cc/posts/dtsk/"}</script>
<!-- End Jekyll SEO tag -->


  <title>Deconstructing the Deep TSK Fuzzy Classifier with Stacked Generalization | the0cp
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="the0cp">
<meta name="application-name" content="the0cp">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.6.0/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.29.0/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- JavaScript -->

  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/avatar.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">the0cp</a>
    <p class="site-subtitle fst-italic mb-0">üß©Jigsaw Falling Into Placeüíª</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    

    
      

      
        <a
          href="https://github.com/the0cp"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/T_Ccooper"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['theo','the0cp.cc'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>Deconstructing the Deep TSK Fuzzy Classifier with Stacked Generalization</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
      

      

      <!-- add image placeholder -->
      

    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  




<!-- return -->










<article class="px-1" data-toc="true">
  <header>
    <h1 data-toc-skip>Deconstructing the Deep TSK Fuzzy Classifier with Stacked Generalization</h1>
    
      <p class="post-desc fw-light mb-4">A detailed technical analysis of the Deep Takagi-Sugeno-Kang Fuzzy Classifier (D-TSK-FC), a novel machine learning model designed to achieve both high performance and clear interpretability. This article breaks down the model's unique stacked architecture, its layer-by-layer training algorithm based on the Least Learning Machine (LLM), and the core principles that guarantee its "triplely concise interpretability."
</p>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1752246000"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Jul 12, 2025
</time>

      </span>

      <!-- lastmod date -->
      

      
        
        
        

        

        <div class="mt-3 mb-3">
          <a href="/assets/img/blog/dtsk/cover.webp" class="popup img-link preview-img blur"><img data-src="/assets/img/blog/dtsk/cover.webp"  alt="Preview Image" width="1200" height="630" data-lqip="true" src="/assets/img/placeholder.webp"></a></div>
      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              
                <a href="https://github.com/the0cp/">Theodore Cooper</a>
                
              
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="2929 words"
>
  <em>16 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  
    <div id="toc-bar" class="d-flex align-items-center justify-content-between invisible">
      <span class="label text-truncate">Deconstructing the Deep TSK Fuzzy Classifier with Stacked Generalization</span>
      <button type="button" class="toc-trigger btn me-1">
        <i class="fa-solid fa-list-ul fa-fw"></i>
      </button>
    </div>

    <button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm">
      <span class="label ps-2 pe-1">Contents</span>
      <i class="fa-solid fa-angle-right fa-fw"></i>
    </button>

    <dialog id="toc-popup" class="p-0">
      <div class="header d-flex flex-row align-items-center justify-content-between">
        <div class="label text-truncate py-2 ms-4">Deconstructing the Deep TSK Fuzzy Classifier with Stacked Generalization</div>
        <button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75">
          <i class="fas fa-close"></i>
        </button>
      </div>
      <div id="toc-popup-content" class="px-4 py-3 pb-4"></div>
    </dialog>
  

  <div class="content">
    <p>In the landscape of modern machine learning, a persistent challenge lies at the intersection of performance and transparency. Deep learning architectures have achieved state-of-the-art results across numerous domains, yet their ‚Äúblack box‚Äù nature often makes them unsuitable for high-stakes applications where interpretability is paramount. Conversely, traditional rule-based models, such as fuzzy systems, offer clear, human-readable logic but may not reach the same level of predictive accuracy.</p>

<p>The Deep Takagi-Sugeno-Kang Fuzzy Classifier (D-TSK-FC) represents an ambitious attempt to resolve this dichotomy. It is engineered from the ground up to be a ‚Äúwhite box‚Äù deep model‚Äîone that provides both enhanced classification performance and a guarantee of clear interpretability. The model achieves this by creating a novel synergy between the logical structure of TSK fuzzy systems, the error-correcting power of stacked generalization, and the computational efficiency of the Least Learning Machine (LLM).</p>

<h2 id="base-unit"><span class="me-2">Base Unit</span><a href="#base-unit" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>The most fundamental component of the model is a specialized zero-order TSK fuzzy classifier. This choice is deliberate, prioritizing interpretability at the most granular level.</p>

<h3 id="first-interpretability-guarantee"><span class="me-2">First Interpretability Guarantee</span><a href="#first-interpretability-guarantee" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>To ensure the premise (the ‚ÄúIF‚Äù part) of the rules are linguistically clear, the model adopts a fixed fuzzy partition strategy.</p>

<ul>
  <li>It employs five Gaussian membership functions (GMFs) for every input feature.</li>
  <li>The centers of these GMFs are permanently fixed at <code class="language-plaintext highlighter-rouge">[0, 0.25, 0.5, 0.75, 1]</code>.</li>
  <li>They are assigned the explicit linguistic labels: ‚Äúvery low, low, medium, high, very high‚Äù.</li>
</ul>

<p>This design ensures that the definition of a concept like ‚Äúlow‚Äù is consistent across all rules (always centered at 0.25), which avoids the semantic ambiguity that can arise from learned or irregularly shaped membership functions.</p>

<h3 id="second-interpretability-guarantee"><span class="me-2">Second Interpretability Guarantee</span><a href="#second-interpretability-guarantee" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>To reduce rule complexity, the model designs rules that do not necessarily use all input features. This simplification is achieved through two randomly generated matrices.</p>

<ul>
  <li><strong>Feature Selector Matrix ($\Upsilon$)</strong>: This is a $d \times K$ matrix (where $d$ is the number of features and $K$ is the number of rules). Each element, $\gamma_{jk}$, acts as a binary ‚Äúswitch,‚Äù determining if feature <code class="language-plaintext highlighter-rouge">j</code> is used in rule <code class="language-plaintext highlighter-rouge">k</code>. If $\gamma_{jk}=0$, the feature is ignored in that specific rule.</li>
  <li><strong>Rule Combination Matrix ($RC$)</strong>: This is a $d \times 5 \times K$ binary matrix. For the features selected by the $\Upsilon$ matrix, the $RC$ matrix indicates which of the five fixed GMFs (e.g., ‚Äúhigh‚Äù or ‚Äúlow‚Äù) is adopted for that feature in that rule.</li>
</ul>

<p>Through the combined action of these two matrices, a simple rule that only focuses on a subset of features is automatically generated, as exemplified in following equation.</p>

<p><strong>IF</strong> $x_1$ is <strong>low</strong> (with $\gamma_{1k}=1$) <strong>AND</strong> $x_2$ is <strong>high</strong> (with  $\gamma_{2k}=1$) <strong>AND</strong> $x_3$ is <strong>not involved</strong> (with $\gamma_{3k}=0$) $\cdot \cdot \cdot$ <strong>THEN</strong> a class output is $p_0^k$</p>

<p>This design enhances readability and mitigates the risk of the ‚Äúcurse of dimensionality‚Äù. Furthermore, the structure of this unit is analogous to a single-layer feedforward network, which allows it to be trained efficiently using the <strong>Least Learning Machine (LLM)</strong> algorithm.</p>

<h2 id="the-stacked-structure"><span class="me-2">The Stacked Structure</span><a href="#the-stacked-structure" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>While the base unit is interpretable, achieving high performance and accuracy requires stacking them to create a deep structure. The model‚Äôs deep architecture is built upon the stacked generalization principle, with the goal of correcting prediction errors layer by layer to enhance overall performance.</p>

<p>The data flow mechanism is the most critical innovation of this model and the source of the third interpretability guarantee.</p>

<ul>
  <li>
    <p><strong>Layer 1</strong>: The model‚Äôs input is the original training dataset, $X_1 = X$. The first base-building unit trains on this data and produces a prediction result, $Y_1$.</p>
  </li>
  <li>
    <p><strong>The Core Mechanism</strong>: The information passed to the next layer is not the output $Y_1$ itself. Instead, it is the original training set plus a random shift derived from the previous layer‚Äôs prediction results.</p>
  </li>
  <li>
    <p>The input for the next layer, $X_2$, is calculated as follows:</p>
  </li>
</ul>

\[X_2 = X + \alpha Y_1 Z_1\]

<p>Here, $X$ is the original training set, $Y_1$ is the prediction output from the first layer, $\alpha$ is a small given constant, and $Z_1$ is a random projection matrix.</p>

<h3 id="third-interpretability-guarantee"><span class="me-2">Third Interpretability Guarantee</span><a href="#third-interpretability-guarantee" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<ul>
  <li>This unique data flow ensures that every base unit operates on the same input space as the original data.</li>
  <li>This is a key distinction from traditional fuzzy systems, where subsequent layers operate on abstract, non-physical outputs from previous layers, making their rules difficult to interpret.</li>
  <li>In the D-TSK-FC, because each layer‚Äôs input is just a slightly perturbed version of the original data $X$, any feature referenced in a rule‚Äîregardless of the layer‚Äîis always the original feature with its clear physical meaning.</li>
</ul>

<h3 id="example"><span class="me-2">Example</span><a href="#example" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<h4 id="initial"><span class="me-2">Initial</span><a href="#initial" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<ul>
  <li>Training Data ($X$): We assume a training set with $N=3$ samples and $d=2$ features. The data has been normalized to a $[0, 1]$ range.</li>
</ul>

\[X = \begin{pmatrix} x_1 \\ x_2 \\ x_3 \end{pmatrix} = \begin{pmatrix} 0.2 &amp; 0.8 \\ 0.9 &amp; 0.1 \\ 0.3 &amp; 0.6 \end{pmatrix}\]

<ul>
  <li>
    <p>Class Labels ($T$): This is a binary classification problem ($m=2$), with labels represented using one-hot encoding.</p>

    <ul>
      <li>Sample 1 belongs to Class 2</li>
      <li>Sample 2 belongs to Class 1</li>
      <li>Sample 3 belongs to Class 2</li>
    </ul>
  </li>
</ul>

\[T = \begin{pmatrix} t_1 \\ t_2 \\ t_3 \end{pmatrix} = \begin{pmatrix} 0 &amp; 1 \\ 1 &amp; 0 \\ 0 &amp; 1 \end{pmatrix}\]

<ul>
  <li>
    <p>Hyperparameters:</p>

    <ul>
      <li>Perturbation Coefficient: $\alpha = 0.03$.</li>
      <li>Model Depth: $DP = 2$.</li>
    </ul>
  </li>
</ul>

<hr />

<h4 id="the-calculation"><span class="me-2">The Calculation</span><a href="#the-calculation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<h5 id="layer-1"><span class="me-2">Layer 1</span><a href="#layer-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5>

<ul>
  <li>
    <p><strong>Input</strong>: The input for the first base-building unit is the original training data, $X_1 = X$.</p>
  </li>
  <li>
    <p><strong>Training and Prediction</strong>:</p>

    <ul>
      <li>The model is trained on the data pair $(X_1, T)$. This process involves randomly generating the rule structure, calculating the hidden layer matrix $H_1$, and using the LLM algorithm to analytically compute the output weights $\beta_1$.</li>
      <li>After training, the model predicts on the input $X_1$ to get the prediction output matrix $Y_1 = H_1\beta_1$.</li>
      <li>Assuming the resulting prediction matrix $Y_1$ (a $3 \times 2$ matrix) is as follows:</li>
    </ul>
  </li>
</ul>

\[Y_1 = \begin{pmatrix}
0.3 &amp; 0.7 \\
0.6 &amp; 0.4 \\
0.4 &amp; 0.6
\end{pmatrix}\]

<p><strong>Interpretation</strong>: The model predicts sample 1 belongs to class 2 (0.7 probability), sample 2 to class 1 (0.6 probability), and sample 3 to class 2 (0.6 probability). The directionality is correct, but the confidence is not high.</p>

<h5 id="input-for-layer-2"><span class="me-2">Input for Layer 2</span><a href="#input-for-layer-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5>

<p>This is the core step of the stacked architecture. We will now generate the input for the second layer, $X_2$, based on the output of the first layer, $Y_1$.</p>

<ul>
  <li>
    <p>The Core Formula:</p>

\[X_2 = X + \alpha Y_1 Z_1\]
  </li>
  <li>
    <p>Generate Matrix ($Z_1$):</p>

    <ul>
      <li>We need a random matrix $Z_1$. For the matrix multiplication to be valid, its dimensions must be $m \times d$ (i.e., $2 \times 2$).</li>
      <li>Let‚Äôs assume the randomly generated $Z_1$ is as follows (with elements between 0 and 1):</li>
    </ul>
  </li>
</ul>

\[Z_1 = \begin{pmatrix}
0.8 &amp; 0.2 \\
0.3 &amp; 0.9
\end{pmatrix}\]

<ul>
  <li>Calculate $\alpha Y_1 Z_1$:</li>
</ul>

\[\begin{pmatrix}
   0.3 &amp; 0.7 \\
   0.6 &amp; 0.4 \\
   0.4 &amp; 0.6
   \end{pmatrix}
   \times
   \begin{pmatrix}
   0.8 &amp; 0.2 \\
   0.3 &amp; 0.9

\end{pmatrix}
=

  \begin{pmatrix}
  0.45 &amp; 0.69 \\
  0.60 &amp; 0.48 \\
  0.50 &amp; 0.62
  \end{pmatrix}\]

\[\text{Perturbation} = 0.03 \times \begin{pmatrix}
       0.45 &amp; 0.69 \\
       0.60 &amp; 0.48 \\
       0.50 &amp; 0.62

     \end{pmatrix}
     =

       \begin{pmatrix}
       0.0135 &amp; 0.0207 \\
       0.0180 &amp; 0.0144 \\
       0.0150 &amp; 0.0186
       \end{pmatrix}\]

<ul>
  <li>Final Input for Layer 2 ($X_2$):</li>
</ul>

\[X_2 = X + \text{Perturbation} 
     =

       \begin{pmatrix}
       0.2135 &amp; 0.8207 \\
       0.9180 &amp; 0.1144 \\
       0.3150 &amp; 0.6186
       \end{pmatrix}\]

<h5 id="layer-2"><span class="me-2">Layer 2</span><a href="#layer-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5>

<ul>
  <li>
    <p><strong>Input</strong>: The second base-building unit now receives the newly computed, slightly perturbed dataset $X_2$ as its input.</p>
  </li>
  <li>
    <p><strong>Training and Prediction</strong>:</p>

    <ul>
      <li>The model now trains on the new data pair $(X_2, T)$. Note that the target labels $T$ do not change.</li>
      <li>The task for this second layer is to learn a mapping from the perturbed data $X_2$ to the original correct labels $T$. The samples in $X_2$ may have been ‚Äúpushed‚Äù into positions that are easier to classify correctly, as the perturbation contained information from the first layer‚Äôs predictions.</li>
      <li>After training, it will produce an output $Y_2$. Since we set the depth $DP=2$, this $Y_2$ is the final prediction result of the entire D-TSK-FC model.</li>
    </ul>
  </li>
</ul>

<h2 id="deep-learning-algorithm"><span class="me-2">Deep Learning Algorithm</span><a href="#deep-learning-algorithm" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>The algorithm‚Äôs core principle is layer-by-layer construction, where it iteratively builds and trains each base-building unit until the desired model depth is achieved.</p>

<p>The algorithm takes the training data ($X$), labels ($T$), and the model depth ($DP$) as input. The process unfolds within a main loop that executes $DP$ times, once for each layer.</p>

<p>For any given layer <code class="language-plaintext highlighter-rouge">dp</code> within the loop, the key steps are as follows:</p>

<ul>
  <li>
    <p><strong>Rule Premise Initialization</strong>: The ‚ÄúIF‚Äù part of all fuzzy rules for the current layer is defined. This is done by randomly generating the Feature Selector Matrix ($\Upsilon_{dp}$) and the Rule Combination Matrix ($RC_{dp}$), which injects the necessary structural randomness for the layer.</p>
  </li>
  <li>
    <p><strong>Hidden Layer Calculation</strong>: The objective of this phase is to compute the firing strength of every rule for every training sample, forming the hidden layer output matrix, $H_{dp}$.</p>

    <ul>
      <li>The process begins by calculating the basic membership grades of each feature for the five fixed Gaussian functions.</li>
      <li>Next, it computes the per-feature activation value, $v_{jl}$.</li>
    </ul>
  </li>
</ul>

\[v_{jl}(x_j^i) = \begin{cases} 1 - \prod_{k=1}^{5} (1 - RC_{dp}(j, k, l)u(k, x_{ij})) &amp; \text{if } \gamma_{jl} = 1 \\ 1 &amp; \text{if } \gamma_{jl} = 0 \end{cases}\]

<p>If a feature is ignored ($\gamma_{jl} = 0$), its contribution to the final product is a neutral <strong>1</strong>. If the feature is used ($\gamma_{jl} = 1$), its activation is calculated. The $1 - \prod(1 - ‚Ä¶)$ structure is a fuzzy logic operator known as the ‚Äúalgebraic sum,‚Äù which acts like an ‚ÄúOR‚Äù gate. It allows the rule to be activated if the feature belongs to any of the GMFs selected by the $RC$ matrix for that rule.</p>

<p>Finally, the overall firing strength for a rule, $w_{il}$, is the product of all its per-feature activations ($v_{jl}$). These values for all samples and rules form the matrix $H_{dp}$.</p>

<ul>
  <li>
    <p><strong>LLM-based Learning</strong>: This is the critical learning step for the layer. The consequent parameters ($\beta_{dp}$) are solved for analytically using the scalable version of the Least Learning Machine formula:</p>

\[\beta_{dp} = \left(\frac{1}{C}I + H_{dp}^T H_{dp}\right)^{-1} H_{dp}^T T\]

    <p>This non-iterative step, which involves inverting a smaller $K_{dp} \times K_{dp}$ matrix, is key to the algorithm‚Äôs efficiency on large datasets.</p>
  </li>
  <li>
    <p><strong>The Stacking</strong>: Once the layer is trained, the algorithm prepares for the next. The layer‚Äôs predictions, $Y_{dp} = H_{dp}\beta_{dp}$, are calculated. This output is then used to generate the perturbed input for the <em>next</em> layer, $X_{dp+1}$, using the core stacking formula: $X_{dp+1} = X + \alpha Y_{dp} Z_{dp}$.</p>
  </li>
</ul>

<p>After the loop completes, the final prediction function of the entire model is the output of the last layer ($Y_{DP} = H_{DP}\beta_{DP}$), and all the interpretable fuzzy rules from each layer can be formally described.</p>

<h2 id="time-complexity-and-prediction"><span class="me-2">Time Complexity and Prediction</span><a href="#time-complexity-and-prediction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<ul>
  <li>
    <p><strong>Time Complexity</strong>: Due to the scalable LLM implementation, the algorithm‚Äôs time complexity is approximately linear with respect to the number of training samples, $N$ (when $N \gg K$). This makes the D-TSK-FC a viable choice for large-scale data problems.</p>
  </li>
  <li>
    <p><strong>The Prediction Process</strong>: The process mirrors the training flow: <code class="language-plaintext highlighter-rouge">z</code> is passed sequentially through the layers. At each layer <code class="language-plaintext highlighter-rouge">dp</code>, the model calculates a prediction $y_{dp}$, which is then used to update the sample‚Äôs representation for the next layer using the same stacking formula: $z_{dp+1} = z + \alpha y_{dp} Z_{dp}$. The final output from the last layer, <code class="language-plaintext highlighter-rouge">DP</code>, is the model‚Äôs definitive prediction for the sample <code class="language-plaintext highlighter-rouge">z</code>.</p>
  </li>
</ul>

<h2 id="python-implement"><span class="me-2">Python Implement</span><a href="#python-implement" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>This Python script provides a complete, from-scratch implementation of the Deep Takagi-Sugeno-Kang Fuzzy Classifier. It is built purely upon the NumPy library, making it a self-contained and transparent representation of the core algorithm without dependencies on high-level deep learning frameworks like PyTorch or TensorFlow.</p>

<p>The script contains a self-contained <code class="language-plaintext highlighter-rouge">if __name__ == '__main__'</code>: block which demonstrates the training and prediction with KDD Cup 1999 dataset.</p>

<p>If you find the training time on your dataset is too long, the best optimization is to migrate the <code class="language-plaintext highlighter-rouge">D_TSK_FC</code> class from using NumPy to using CuPy for GPU acceleration.</p>

<p>KDD Cup 1999 Data Download from Kaggle: <a href="https://www.kaggle.com/datasets/galaxyh/kdd-cup-1999-data?resource=download">kddcup99 - https://www.kaggle.com/datasets/galaxyh/kdd-cup-1999-data?resource=download</a></p>

<h3 id="hyperparameters"><span class="me-2">Hyperparameters:</span><a href="#hyperparameters" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="n">model_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">'</span><span class="s">DP</span><span class="sh">'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>                        <span class="c1"># Model Depth (number of layers)
</span>    <span class="sh">'</span><span class="s">K_dp_list</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>      <span class="c1"># Number of rules for each layer
</span>    <span class="sh">'</span><span class="s">alpha</span><span class="sh">'</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span>                  <span class="c1"># Perturbation coefficient
</span>    <span class="sh">'</span><span class="s">C</span><span class="sh">'</span><span class="p">:</span> <span class="mi">400</span>                        <span class="c1"># Regularization parameter
</span><span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="full-code"><span class="me-2">Full Code:</span><a href="#full-code" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="n">kddcup</span> <span class="kn">import</span> <span class="n">load_kddcup99</span>    <span class="c1"># kddcup99 data loader
</span>
<span class="k">class</span> <span class="nc">D_TSK_FC</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">DP</span><span class="p">,</span> <span class="n">K_dp_list</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">C</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">DP</span> <span class="o">=</span> <span class="n">DP</span>
        <span class="n">self</span><span class="p">.</span><span class="n">K_dp_list</span> <span class="o">=</span> <span class="n">K_dp_list</span>
        <span class="n">self</span><span class="p">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span>
        <span class="n">self</span><span class="p">.</span><span class="n">C</span> <span class="o">=</span> <span class="n">C</span>

        <span class="n">self</span><span class="p">.</span><span class="n">centers</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">self</span><span class="p">.</span><span class="n">sigmas</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">self</span><span class="p">.</span><span class="n">U_matrices</span> <span class="o">=</span> <span class="p">{}</span>   <span class="c1">#  Œ• random 
</span>        <span class="n">self</span><span class="p">.</span><span class="n">RC_matrices</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1">#  RC random 
</span>        <span class="n">self</span><span class="p">.</span><span class="n">Z_matrices</span> <span class="o">=</span> <span class="p">{}</span>   <span class="c1">#  Z random 
</span>        <span class="n">self</span><span class="p">.</span><span class="n">betas</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1">#  Œ≤ weights
</span>
    <span class="k">def</span> <span class="nf">_gaussian_mf</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="nf">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">center</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_calculate_h</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">x_sample</span><span class="p">,</span> <span class="n">dp</span><span class="p">):</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">x_sample</span><span class="p">)</span>
        <span class="n">K_dp</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">K_dp_list</span><span class="p">[</span><span class="n">dp</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">(</span><span class="n">K_dp</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">K_dp</span><span class="p">):</span>
            <span class="n">w_il</span> <span class="o">=</span> <span class="mf">1.0</span> 
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
                <span class="n">gamma_jl</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">U_matrices</span><span class="p">[</span><span class="n">dp</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span>
                
                <span class="k">if</span> <span class="n">gamma_jl</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">v_jl</span> <span class="o">=</span> <span class="mf">1.0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">prod_term</span> <span class="o">=</span> <span class="mf">1.0</span>
                    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
                        <span class="n">u_k</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_gaussian_mf</span><span class="p">(</span><span class="n">x_sample</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">self</span><span class="p">.</span><span class="n">centers</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">self</span><span class="p">.</span><span class="n">sigmas</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                        <span class="n">rc_jkl</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">RC_matrices</span><span class="p">[</span><span class="n">dp</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span>
                        <span class="n">prod_term</span> <span class="o">*=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">rc_jkl</span> <span class="o">*</span> <span class="n">u_k</span><span class="p">)</span>
                    <span class="n">v_jl</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">prod_term</span>
                <span class="n">w_il</span> <span class="o">*=</span> <span class="n">v_jl</span>
            <span class="n">h</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="n">w_il</span>
            
        <span class="k">return</span> <span class="n">h</span>

    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">
        - X (np.ndarray): (N, d)
        - T (np.ndarray): one-hot (N, m)
        </span><span class="sh">"""</span>
        <span class="n">N</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="n">shape</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">T</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">self</span><span class="p">.</span><span class="n">sigmas</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> 
        <span class="c1"># randomly initialize sigma values for Gaussian membership functions
</span>
        <span class="n">X_original</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="nf">copy</span><span class="p">()</span>
        <span class="n">Y_prev</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="k">for</span> <span class="n">dp</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">DP</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">--- Training Layer </span><span class="si">{</span><span class="n">dp</span><span class="si">}</span><span class="s"> ---</span><span class="sh">"</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">dp</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">X_dp</span> <span class="o">=</span> <span class="n">X_original</span>
                <span class="c1"># for the first layer, use the original input
</span>            <span class="k">else</span><span class="p">:</span>
                <span class="n">X_dp</span> <span class="o">=</span> <span class="n">X_original</span> <span class="o">+</span> <span class="n">self</span><span class="p">.</span><span class="n">alpha</span> <span class="o">*</span> <span class="p">(</span><span class="n">Y_prev</span> <span class="o">@</span> <span class="n">self</span><span class="p">.</span><span class="n">Z_matrices</span><span class="p">[</span><span class="n">dp</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="c1"># calculate the perturbed input for the current layer
</span>
            <span class="n">K_dp</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">K_dp_list</span><span class="p">[</span><span class="n">dp</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">self</span><span class="p">.</span><span class="n">U_matrices</span><span class="p">[</span><span class="n">dp</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">K_dp</span><span class="p">))</span>
            <span class="n">self</span><span class="p">.</span><span class="n">RC_matrices</span><span class="p">[</span><span class="n">dp</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">K_dp</span><span class="p">))</span>
            
            <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Calculating hidden layer H...</span><span class="sh">"</span><span class="p">)</span>
            <span class="n">H_dp</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">K_dp</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
                <span class="n">H_dp</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_calculate_h</span><span class="p">(</span><span class="n">X_dp</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dp</span><span class="p">)</span>
                
            <span class="n">I</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">identity</span><span class="p">(</span><span class="n">K_dp</span><span class="p">)</span>               <span class="c1"># identity matrix for regularization
</span>            <span class="n">H_T_H</span> <span class="o">=</span> <span class="n">H_dp</span><span class="p">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">H_dp</span> <span class="o">+</span> <span class="mf">1e-8</span> <span class="o">*</span> <span class="n">I</span>    <span class="c1"># regularization term
</span>            <span class="n">term1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">inv</span><span class="p">((</span><span class="mi">1</span><span class="o">/</span><span class="n">self</span><span class="p">.</span><span class="n">C</span><span class="p">)</span> <span class="o">*</span> <span class="n">I</span> <span class="o">+</span> <span class="n">H_T_H</span><span class="p">)</span>
            <span class="n">term2</span> <span class="o">=</span> <span class="n">H_dp</span><span class="p">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">T</span>
            <span class="n">self</span><span class="p">.</span><span class="n">betas</span><span class="p">[</span><span class="n">dp</span><span class="p">]</span> <span class="o">=</span> <span class="n">term1</span> <span class="o">@</span> <span class="n">term2</span>
            
            <span class="k">if</span> <span class="n">dp</span> <span class="o">&lt;</span> <span class="n">self</span><span class="p">.</span><span class="n">DP</span><span class="p">:</span>
                <span class="n">Y_dp</span> <span class="o">=</span> <span class="n">H_dp</span> <span class="o">@</span> <span class="n">self</span><span class="p">.</span><span class="n">betas</span><span class="p">[</span><span class="n">dp</span><span class="p">]</span>
                <span class="n">Y_prev</span> <span class="o">=</span> <span class="n">Y_dp</span>
                
                <span class="n">self</span><span class="p">.</span><span class="n">Z_matrices</span><span class="p">[</span><span class="n">dp</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">rand</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
        
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">Training complete.</span><span class="sh">"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">X_new</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">--- Starting Prediction ---</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">N_new</span> <span class="o">=</span> <span class="n">X_new</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">N_new</span><span class="p">):</span>
            <span class="n">z_original</span> <span class="o">=</span> <span class="n">X_new</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">z_dp</span> <span class="o">=</span> <span class="n">z_original</span><span class="p">.</span><span class="nf">copy</span><span class="p">()</span>

            <span class="k">for</span> <span class="n">dp</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">DP</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">h_dp</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_calculate_h</span><span class="p">(</span><span class="n">z_dp</span><span class="p">.</span><span class="nf">flatten</span><span class="p">(),</span> <span class="n">dp</span><span class="p">).</span><span class="nf">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                
                <span class="n">y_dp</span> <span class="o">=</span> <span class="n">h_dp</span> <span class="o">@</span> <span class="n">self</span><span class="p">.</span><span class="n">betas</span><span class="p">[</span><span class="n">dp</span><span class="p">]</span>
                
                <span class="k">if</span> <span class="n">dp</span> <span class="o">&lt;</span> <span class="n">self</span><span class="p">.</span><span class="n">DP</span><span class="p">:</span>
                    <span class="n">z_dp</span> <span class="o">=</span> <span class="n">z_original</span> <span class="o">+</span> <span class="n">self</span><span class="p">.</span><span class="n">alpha</span> <span class="o">*</span> <span class="p">(</span><span class="n">y_dp</span> <span class="o">@</span> <span class="n">self</span><span class="p">.</span><span class="n">Z_matrices</span><span class="p">[</span><span class="n">dp</span><span class="p">])</span>
            <span class="n">predicted_class</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">argmax</span><span class="p">(</span><span class="n">y_dp</span><span class="p">)</span>
            <span class="n">predictions</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">predicted_class</span><span class="p">)</span>
            
        <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">'</span><span class="s">__main__</span><span class="sh">'</span><span class="p">:</span>
    <span class="n">kdd_file_path</span> <span class="o">=</span> <span class="sh">'</span><span class="s">kddcup.data</span><span class="sh">'</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">X_train</span><span class="p">,</span> <span class="n">T_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test_true</span><span class="p">,</span> <span class="n">num_classes</span> <span class="o">=</span> <span class="nf">load_kddcup99</span><span class="p">(</span><span class="n">kdd_file_path</span><span class="p">)</span>
        
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">X_train shape: </span><span class="si">{</span><span class="n">X_train</span><span class="p">.</span><span class="n">shape</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">T_train shape: </span><span class="si">{</span><span class="n">T_train</span><span class="p">.</span><span class="n">shape</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">X_test shape: </span><span class="si">{</span><span class="n">X_test</span><span class="p">.</span><span class="n">shape</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">y_test_true shape: </span><span class="si">{</span><span class="n">y_test_true</span><span class="p">.</span><span class="n">shape</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

        <span class="n">model_params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">DP</span><span class="sh">'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">K_dp_list</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
            <span class="sh">'</span><span class="s">alpha</span><span class="sh">'</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">C</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1000</span>
        <span class="p">}</span>
        
        <span class="n">dtsk_fc</span> <span class="o">=</span> <span class="nc">D_TSK_FC</span><span class="p">(</span><span class="o">**</span><span class="n">model_params</span><span class="p">)</span>
        <span class="n">dtsk_fc</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">T_train</span><span class="p">)</span>
        
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">dtsk_fc</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
        
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">--- Results ---</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">accuracy</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">mean</span><span class="p">(</span><span class="n">y_pred</span> <span class="o">==</span> <span class="n">y_test_true</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Accuracy: </span><span class="si">{</span><span class="n">accuracy</span><span class="si">:</span><span class="p">.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s">%</span><span class="sh">"</span><span class="p">)</span>

    <span class="k">except</span> <span class="nb">FileNotFoundError</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="s">Dataset not found</span><span class="sh">"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="dataloader"><span class="me-2">DataLoader</span><a href="#dataloader" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>KDD Cup 1999 dataset loader script:</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="n">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span><span class="p">,</span> <span class="n">LabelEncoder</span>
<span class="kn">from</span> <span class="n">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="k">def</span> <span class="nf">load_kddcup99</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">
    1. load KDD CUP 1999 with pandas.
    2. One-hot encode categorical features.
    3. Min-Max normalize numerical features.
    4. encodes labels to integers.
    5. split dataset
    6. One-hot encode training labels.

    Args:
    - file_path (str): KDD Cup 1999 path
    - test_size (float): split ratio for test set

    Returns:
    - X_train, T_train, X_test, y_test, num_classes
    </span><span class="sh">"""</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Loading data from: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="c1"># Add column names
</span>    <span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span>
        <span class="sh">'</span><span class="s">duration</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">protocol_type</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">service</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">flag</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">src_bytes</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">dst_bytes</span><span class="sh">'</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">land</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">wrong_fragment</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">urgent</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">hot</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">num_failed_logins</span><span class="sh">'</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">logged_in</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">num_compromised</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">root_shell</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">su_attempted</span><span class="sh">'</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">num_root</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">num_file_creations</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">num_shells</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">num_access_files</span><span class="sh">'</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">num_outbound_cmds</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">is_host_login</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">is_guest_login</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">count</span><span class="sh">'</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">srv_count</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">serror_rate</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">srv_serror_rate</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">rerror_rate</span><span class="sh">'</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">srv_rerror_rate</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">same_srv_rate</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">diff_srv_rate</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">srv_diff_host_rate</span><span class="sh">'</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">dst_host_count</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">dst_host_srv_count</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">dst_host_same_srv_rate</span><span class="sh">'</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">dst_host_diff_srv_rate</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">dst_host_same_src_port_rate</span><span class="sh">'</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">dst_host_srv_diff_host_rate</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">dst_host_serror_rate</span><span class="sh">'</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">dst_host_srv_serror_rate</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">dst_host_rerror_rate</span><span class="sh">'</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">dst_host_srv_rerror_rate</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">label</span><span class="sh">'</span>
    <span class="p">]</span>
    
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">column_names</span><span class="p">).</span><span class="nf">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
    

    <span class="n">label_counts</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">label</span><span class="sh">'</span><span class="p">].</span><span class="nf">value_counts</span><span class="p">()</span>
    <span class="n">rare_classes</span> <span class="o">=</span> <span class="n">label_counts</span><span class="p">[</span><span class="n">label_counts</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">].</span><span class="n">index</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">rare_classes</span><span class="p">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Found </span><span class="si">{</span><span class="nf">len</span><span class="p">(</span><span class="n">rare_classes</span><span class="p">)</span><span class="si">}</span><span class="s"> rare classes with only 1 sample: </span><span class="si">{</span><span class="nf">list</span><span class="p">(</span><span class="n">rare_classes</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">label</span><span class="sh">'</span><span class="p">].</span><span class="nf">isin</span><span class="p">(</span><span class="n">rare_classes</span><span class="p">)]</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Removed rare class samples. New dataset size: </span><span class="si">{</span><span class="nf">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="si">}</span><span class="s"> records.</span><span class="sh">"</span><span class="p">)</span>


    <span class="c1"># extract labels
</span>    <span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="nf">drop</span><span class="p">(</span><span class="sh">'</span><span class="s">label</span><span class="sh">'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">label</span><span class="sh">'</span><span class="p">]</span>
    
    <span class="n">categorical_cols</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">protocol_type</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">service</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">flag</span><span class="sh">'</span><span class="p">]</span>
    
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Preprocessing data...</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">X_processed</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">get_dummies</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">categorical_cols</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    
    <span class="c1"># label encoding
</span>    <span class="n">label_encoder</span> <span class="o">=</span> <span class="nc">LabelEncoder</span><span class="p">()</span>
    <span class="n">y_encoded</span> <span class="o">=</span> <span class="n">label_encoder</span><span class="p">.</span><span class="nf">fit_transform</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">num_classes</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">label_encoder</span><span class="p">.</span><span class="n">classes_</span><span class="p">)</span>
    
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="nf">train_test_split</span><span class="p">(</span>
        <span class="n">X_processed</span><span class="p">,</span> <span class="n">y_encoded</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="n">test_size</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y_encoded</span>
    <span class="p">)</span>

    <span class="n">numerical_cols</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="nf">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">number</span><span class="p">).</span><span class="n">columns</span>
    <span class="n">scaler</span> <span class="o">=</span> <span class="nc">MinMaxScaler</span><span class="p">()</span>
    
    <span class="n">X_train</span><span class="p">[</span><span class="n">numerical_cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">.</span><span class="nf">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="n">numerical_cols</span><span class="p">])</span>
    <span class="n">X_test</span><span class="p">[</span><span class="n">numerical_cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">.</span><span class="nf">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">[</span><span class="n">numerical_cols</span><span class="p">])</span>
    
    <span class="n">T_train</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">eye</span><span class="p">(</span><span class="n">num_classes</span><span class="p">)[</span><span class="n">y_train</span><span class="p">]</span>
    
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Preprocessing complete.</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">X_train</span><span class="p">.</span><span class="nf">to_numpy</span><span class="p">(),</span> <span class="n">T_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">.</span><span class="nf">to_numpy</span><span class="p">(),</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">num_classes</span>
</pre></td></tr></tbody></table></code></div></div>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/ml/">ML</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/fuzzy/"
            class="post-tag no-text-decoration"
          >Fuzzy</a>
        
          <a
            href="/tags/ai/"
            class="post-tag no-text-decoration"
          >AI</a>
        
          <a
            href="/tags/ml/"
            class="post-tag no-text-decoration"
          >ML</a>
        
          <a
            href="/tags/dl/"
            class="post-tag no-text-decoration"
          >DL</a>
        
          <a
            href="/tags/math/"
            class="post-tag no-text-decoration"
          >Math</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=Deconstructing%20the%20Deep%20TSK%20Fuzzy%20Classifier%20with%20Stacked%20Generalization%20-%20the0cp&url=https%3A%2F%2Fthe0cp.cc%2Fposts%2Fdtsk%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=Deconstructing%20the%20Deep%20TSK%20Fuzzy%20Classifier%20with%20Stacked%20Generalization%20-%20the0cp&u=https%3A%2F%2Fthe0cp.cc%2Fposts%2Fdtsk%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=https%3A%2F%2Fthe0cp.cc%2Fposts%2Fdtsk%2F&text=Deconstructing%20the%20Deep%20TSK%20Fuzzy%20Classifier%20with%20Stacked%20Generalization%20-%20the0cp" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

      

      <a href="https://www.reddit.com/submit?url=https%3A%2F%2Fthe0cp.cc%2Fposts%2Fdtsk%2F&title=Deconstructing%20the%20Deep%20TSK%20Fuzzy%20Classifier%20with%20Stacked%20Generalization%20-%20the0cp" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Reddit" aria-label="Reddit">
        <i class="fa-fw fa-brands fa-square-reddit"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/ai-code/">Teach AI to Code Better - A Guide to Sanity and Productivity</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/dtsk/">Deconstructing the Deep TSK Fuzzy Classifier with Stacked Generalization</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/llm/">The Mechanics of the Least Learning Machine</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/fcm/">Fuzzy C-Means (FCM) Clustering & Subtractive Clustering Overview</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/mamdani/">Mamdani Fuzzy Neural Network - Architecture & Learning Algorithm</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/linux/">Linux</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ai/">AI</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/c-c/">C/C++</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/math/">Math</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ml/">ML</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/pentest/">Pentest</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/fuzzy/">Fuzzy</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/qt/">Qt</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/windows/">Windows</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/beautify/">Beautify</a>
      
    </div>
  </section>


            </div>

            
              
              






  <section id="toc-wrapper" class="ps-0 pe-4">
    <h2 class="panel-heading ps-3 mb-2">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    










  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/fcm/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1751900400"
  data-df="ll"
  
>
  Jul  8, 2025
</time>

              <h4 class="pt-0 my-2">Fuzzy C-Means (FCM) Clustering & Subtractive Clustering Overview</h4>
              <div class="text-muted">
                <p>Learn the theory and implementation of Fuzzy C-Means (FCM) and Subtractive Clustering. Clustering is a fundamental task in unsupervised machine learning, and Fuzzy C-Means (FCM) clustering stands o...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/mamdani/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1751814000"
  data-df="ll"
  
>
  Jul  7, 2025
</time>

              <h4 class="pt-0 my-2">Mamdani Fuzzy Neural Network - Architecture & Learning Algorithm</h4>
              <div class="text-muted">
                <p>A comprehensive guide to the Mamdani-based Fuzzy Neural Network (FNN). Learn its 5-layer architecture, step-by-step fuzzy inference process, and how to train it using the error backpropagation algo...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/ts-fuzzy/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1751727600"
  data-df="ll"
  
>
  Jul  6, 2025
</time>

              <h4 class="pt-0 my-2">A Comprehensive Guide to the Takagi-Sugeno (T-S) Fuzzy Inference Model</h4>
              <div class="text-muted">
                <p>Explore the Takagi-Sugeno (T-S) fuzzy inference model, a powerful tool for modeling and controlling complex nonlinear systems. This guide covers the structure, mathematical principles, step-by-step...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/llm/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>The Mechanics of the Least Learning Machine</p>
    </a>
  

  
    <a
      href="/posts/ai-code/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>Teach AI to Code Better - A Guide to Sanity and Productivity</p>
    </a>
  
</nav>

            
              
              <!-- The comments switcher -->


            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>¬©
    <time>2025</time>

    
      <!--<a href="https://twitter.com/T_Ccooper">Theodore Cooper</a>.-->
      Theodore Cooper.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >
      <!--All rights reserved.-->
      </span>
    
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/linux/">Linux</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ai/">AI</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/c-c/">C/C++</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/math/">Math</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ml/">ML</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/pentest/">Pentest</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/fuzzy/">Fuzzy</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/qt/">Qt</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/windows/">Windows</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/beautify/">Beautify</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->
    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.29.0/dist/tocbot.min.js"></script>







<script src="/assets/js/dist/post.min.js"></script>


  <!-- MathJax -->
  <script src="/assets/js/data/mathjax.js"></script>
  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-chtml.js"></script>


<!-- Pageviews -->

  

  







    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5">Oops! No results found.</p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

