import*as dom from"./dom/index.js";import{swalClasses}from"./classes.js";import{fixScrollbar}from"./scrollbarFix.js";import{iOSfix}from"./iosFix.js";import{IEfix}from"./ieFix.js";import{setAriaHidden}from"./aria.js";import globalState from"../globalState.js";export const SHOW_CLASS_TIMEOUT=10;export const openPopup=o=>{const e=dom.getContainer(),t=dom.getPopup();"function"==typeof o.willOpen?o.willOpen(t):"function"==typeof o.onBeforeOpen&&o.onBeforeOpen(t);const i=window.getComputedStyle(document.body).overflowY;addClasses(e,t,o),setTimeout((()=>{setScrollingVisibility(e,t)}),10),dom.isModal()&&(fixScrollContainer(e,o.scrollbarPadding,i),setAriaHidden()),dom.isToast()||globalState.previousActiveElement||(globalState.previousActiveElement=document.activeElement),runDidOpen(t,o),dom.removeClass(e,swalClasses["no-transition"])};const runDidOpen=(o,e)=>{"function"==typeof e.didOpen?setTimeout((()=>e.didOpen(o))):"function"==typeof e.onOpen&&setTimeout((()=>e.onOpen(o)))},swalOpenAnimationFinished=o=>{const e=dom.getPopup();if(o.target!==e)return;const t=dom.getContainer();e.removeEventListener(dom.animationEndEvent,swalOpenAnimationFinished),t.style.overflowY="auto"},setScrollingVisibility=(o,e)=>{dom.animationEndEvent&&dom.hasCssAnimation(e)?(o.style.overflowY="hidden",e.addEventListener(dom.animationEndEvent,swalOpenAnimationFinished)):o.style.overflowY="auto"},fixScrollContainer=(o,e,t)=>{iOSfix(),IEfix(),e&&"hidden"!==t&&fixScrollbar(),setTimeout((()=>{o.scrollTop=0}))},addClasses=(o,e,t)=>{dom.addClass(o,t.showClass.backdrop),e.style.setProperty("opacity","0","important"),dom.show(e),setTimeout((()=>{dom.addClass(e,t.showClass.popup),e.style.removeProperty("opacity")}),10),dom.addClass([document.documentElement,document.body],swalClasses.shown),t.heightAuto&&t.backdrop&&!t.toast&&dom.addClass([document.documentElement,document.body],swalClasses["height-auto"])};